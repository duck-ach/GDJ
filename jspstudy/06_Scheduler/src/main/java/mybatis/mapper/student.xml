<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace="mapper의 패키지 경로" -->

<mapper namespace="mybatis.mapper.student"> <!-- 이 mapper의 이름 -->
	 
	 <!-- 1. 학생목록 -->
	 <select id="selectAllStudents" resultType="Student">
	 	SELECT STU_NO, NAME, KOR, ENG, MATH, AVE, GRADE
	 	  FROM STUDENT
	 	 ORDER BY STU_NO
	 </select>
	 
	 <!-- 2. 전체학생수 -->
	 <select id="selectAllStudentsCount" resultType="int">
	 	SELECT COUNT(*)
	 	  FROM STUDENT
	 </select>
	 
	 <!-- 3. 전체평균 -->
	 <select id="selectAllStudentAverage" resultType="double">
	 	SELECT NVL(AVG(AVE), 0)
	 	  FROM STUDENT
	 </select>
	 <!-- 
	 	NVL 함수 NULL값이 반환될 것 같으면 대신 '0'을 반환하겠다.
	  -->
	  
	 <!-- 4. 학생등록 -->
	 <insert id="insertStudent" parameterType="Student">
	 	INSERT INTO STUDENT
	 		(STU_NO, NAME, KOR, ENG, MATH, AVE, GRADE)
	 	VALUES
	 		(STUDENT_SEQ.NEXTVAL, #{name}, #{kor}, #{eng}, #{math}, #{ave}, #{grade})
	 </insert>
	 
	 <!-- 5. 평균범위조회 -->
	 <select id="selectStudentsByAve" parameterType="Map" resultType="Student">
	 	SELECT STU_NO, NAME, KOR, ENG, MATH, AVE, GRADE
	 	  FROM STUDENT
	 	 WHERE AVE >= #{begin} AND AVE <![CDATA[<]]>= #{end}
	 </select>
	 
	 <!-- 6. 평균범위조회 : 개수 -->
	 <select id="selectStudentsByAveCount" parameterType="Map" resultType="int">
	 	SELECT COUNT(*)
	 	  FROM STUDENT
	 	 WHERE AVE >= #{begin} AND AVE <![CDATA[<]]>= #{end}
	 </select>
	 
	 <!-- 7. 평균범위조회 : 평균 -->
	 <select id="selectStudentsByAveAverage" parameterType="Map" resultType="double">
	 	SELECT NVL(AVG(AVE), 0)
	 	  FROM STUDENT
	 	 WHERE AVE >= #{begin} AND AVE <![CDATA[<]]>= #{end}
	 </select>
	 
	 <!-- 8. 학생삭제 -->
	 <delete id="deleteStudent" parameterType="int">
	 	DELETE
	 	  FROM STUDENT
	 	 WHERE STU_NO = #{stuNo}
	 </delete>
	 
	 
</mapper>